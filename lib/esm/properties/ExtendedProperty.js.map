{"version":3,"file":"ExtendedProperty.js","sources":["../../../src/properties/ExtendedProperty.js"],"sourcesContent":["import { BaseProperty } from \"./BaseProperty.js\";\nimport { MissingArgument, InvalidArgument } from \"../errors/index.js\";\n\nexport class ExtendedProperty extends BaseProperty {\n  static identifier = \"ExtendedProperty\";\n  static cardinality = \"*\";\n  static acceptableParamTypes = new Set([\n    \"LanguageParameter\",\n    \"ValueParameter\",\n    \"PrefParameter\",\n    \"AltidParameter\",\n    \"PIDParameter\",\n    \"TypeParameter\",\n    \"MediatypeParameter\",\n    \"CalscaleParameter\",\n    \"SortAsParameter\",\n    \"GeoParameter\",\n    \"TzParameter\",\n    \"AnyParameter\",\n    \"LabelParameter\",\n    \"CCParameter\",\n    \"IndexParameter\",\n    \"LevelParameter\",\n  ]);\n  static acceptableValTypes = new Set([\n    \"TextType\",\n    \"TextListType\",\n    \"BooleanType\",\n    \"DateTimeType\",\n    \"DateTimeListType\",\n    \"IntegerType\",\n    \"IntegerListType\",\n    \"FloatType\",\n    \"FloatListType\",\n    \"LanguageTagType\",\n    \"URIType\",\n    \"SexType\",\n    \"SpecialValueType\",\n  ]);\n\n  #propRegExp = /^x-[a-z0-9-]+$/i;\n  #params;\n  #value;\n\n  get params() {\n    return this.#params\n      .reduce((parametersArray, currentParameter) => {\n        parametersArray.push(currentParameter.repr());\n        return parametersArray;\n      }, [])\n      .join(\";\");\n  }\n\n  get paramsXML() {\n    return this.#params.reduce(\n      (accumulatedParameters, currentParameter) =>\n        accumulatedParameters + currentParameter.reprXML(),\n      \"\"\n    );\n  }\n\n  get paramsJSON() {\n    return this.#params.reduce(\n      (accumulatedParameters, currentParameter) => ({\n        ...currentParameter.reprJSON(),\n        ...accumulatedParameters,\n      }),\n      {}\n    );\n  }\n\n  get value() {\n    return this.#value.repr();\n  }\n\n  get valueXML() {\n    return this.#value.reprXML();\n  }\n\n  get valueJSON() {\n    return this.#value.reprJSON();\n  }\n\n  #validate(prop, params, value) {\n    if (\n      typeof prop === \"undefined\" ||\n      typeof params === \"undefined\" ||\n      typeof value === \"undefined\"\n    )\n      throw new MissingArgument(\n        \"Property, parameter and value for ExtendedProperty must be supplied\"\n      );\n    else if (!Array.isArray(params))\n      throw new InvalidArgument(\n        \"Parameters for ExtendedProperty must be passed in an array\"\n      );\n    else if (!this.#propRegExp.test(prop))\n      throw new InvalidArgument(\"Invalid property for ExtendedProperty\");\n\n    const parameterInstanceCount = new Set();\n\n    if (\n      !params.every((param) => {\n        if (param.constructor.identifier !== \"AnyParameter\") {\n          if (parameterInstanceCount.has(param.constructor.identifier))\n            throw new InvalidArgument(\n              \"Parameters must not have more than one instance supplied\"\n            );\n          else parameterInstanceCount.add(param.constructor.identifier);\n        } else {\n          if (parameterInstanceCount.has(param.param))\n            throw new InvalidArgument(\n              \"Parameters must not have more than one instance supplied\"\n            );\n          else parameterInstanceCount.add(param.param);\n        }\n\n        if (param.constructor.identifier === \"ValueParameter\")\n          return param.value === value.repr().toLowerCase();\n        return this.constructor.acceptableParamTypes.has(\n          param.constructor.identifier\n        );\n      })\n    )\n      throw new TypeError(\n        \"Some of the parameters passed are not valid parameters for ExtendedProperty\"\n      );\n    else if (\n      !this.constructor.acceptableValTypes.has(value.constructor.identifier)\n    )\n      throw new TypeError(\"Invalid type for value of ExtendedProperty\");\n  }\n\n  constructor(prop, params, value) {\n    super();\n\n    this.#validate(prop, params, value);\n    this.prop = prop.toString().toUpperCase();\n    this.#params = params;\n    this.#value = value;\n\n    this.checkAbstractPropertiesAndMethods();\n    Object.freeze(this);\n  }\n}\n\nObject.freeze(ExtendedProperty);\n"],"names":["ExtendedProperty","prop","params","value","toString","toUpperCase","checkAbstractPropertiesAndMethods","Object","freeze","reduce","parametersArray","currentParameter","push","repr","join","accumulatedParameters","reprXML","_objectSpread","reprJSON","BaseProperty","MissingArgument","Array","isArray","InvalidArgument","test","parameterInstanceCount","Set","every","param","constructor","identifier","has","add","toLowerCase","acceptableParamTypes","TypeError","acceptableValTypes"],"mappings":"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"}